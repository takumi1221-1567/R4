<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>R4 — KYUROKU.ainas</title>
    <link rel="stylesheet" href="/css/style.css">

    <!-- Three.js import map -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/"
        }
    }
    </script>
</head>
<body>
    <div id="app-container">

        <!-- タップで開始オーバーレイ（iOS音声アンロック用） -->
        <div id="start-overlay">
            <div class="overlay-content">
                <p class="overlay-title">タップして開始</p>
                <p class="overlay-sub">音声の再生を有効にします</p>
            </div>
        </div>

        <!-- 3D キャラクター表示（全画面背景） -->
        <div id="character-container">
            <canvas id="three-canvas"></canvas>
        </div>

        <!-- モード表示（右上） -->
        <div id="mode-indicator" class="castoff-mode">
            <span id="mode-text">キャストオフ</span>
        </div>

        <!-- ステータス表示（左上） -->
        <div id="status-indicator" class="hidden">
            <div class="status-dot"></div>
            <span id="status-text">考え中...</span>
        </div>

        <!-- レスポンス表示（入力欄の上） -->
        <div id="response-display" class="hidden"></div>

        <!-- 入力エリア（下部） -->
        <div id="input-area">
            <div id="input-container">
                <input
                    type="text"
                    id="user-input"
                    placeholder="KYUROKUに話しかける..."
                    autocomplete="off"
                >
                <button id="mic-button" aria-label="音声入力">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
                        <path d="M12 14C13.66 14 15 12.66 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M19 11C19 14.866 15.866 18 12 18C8.13401 18 5 14.866 5 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 18V22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M8 22H16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
            <button id="send-button" class="hidden" aria-label="送信">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
                    <path d="M22 2L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
        </div>

    </div>

    <!-- 3Dシーン（module） -->
    <script type="module" src="/js/scene.js"></script>
    <!-- AIチャット + 音声 -->
    <script src="/js/app.js"></script>
</body>
</html>
